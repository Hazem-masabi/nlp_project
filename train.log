02/03/2025 17:23:18 - INFO - Python Version = 3.11.11 (main, Dec  4 2024, 08:55:07) [GCC 11.4.0] on Linux #1 SMP PREEMPT_DYNAMIC Thu Jun 27 21:05:47 UTC 2024 (Linux-6.1.85+-x86_64-with-glibc2.35)
02/03/2025 17:23:18 - INFO - Torch Version = 2.5.1+cu124 (CUDA 12.4) with bfloat16 = False (Git commit = a8d6afb511a69687bbb2b7e88a3cf67917e1697e)
02/03/2025 17:23:18 - INFO - Git commit = 39b95b72b7414a58d6762363f0fe115452317db8 on c01d008f4610 (tree is dirty)
02/03/2025 17:23:18 - WARNING - diff --git a/iter/modeling_iter2.py b/iter/modeling_iter2.py
index d29bf37..27f88f8 100644
--- a/iter/modeling_iter2.py
+++ b/iter/modeling_iter2.py
@@ -98,6 +98,37 @@ class IsSpan(FFN):
         return super().forward(x)
 
 
+class BracketingLayer(Module):
+    def __init__(self, config: ITERConfig):
+        super().__init__()
+        self.config = config
+        # طبقة خطية لتحديد مواقـع الأقواس
+        self.bracket_start = Linear(config.d_model, 1)  # لتحديد بداية الأقواس
+        self.bracket_end = Linear(config.d_model, 1)    # لتحديد نهاية الأقواس
+        self.type_classifier = Linear(config.d_model, config.num_types)  # لتحديد نوع الكائن
+
+    def forward(self, x: Tensor) -> tuple[Tensor, Tensor, Tensor]:
+        """
+        Args:
+            x (Tensor): تمثيل النص من النموذج، shape: [B, N, H]
+        
+        Returns:
+            start_logits (Tensor): logits لبداية الأقواس، shape: [B, N]
+            end_logits (Tensor): logits لنهاية الأقواس، shape: [B, N]
+            type_logits (Tensor): logits لأنواع الكائنات، shape: [B, N, num_types]
+        """
+        # تحديد بداية الأقواس
+        start_logits = self.bracket_start(x).squeeze(-1)  # [B, N]
+        
+        # تحديد نهاية الأقواس
+        end_logits = self.bracket_end(x).squeeze(-1)      # [B, N]
+        
+        # تحديد نوع الكائن
+        type_logits = self.type_classifier(x)             # [B, N, num_types]
+        
+        return start_logits, end_logits, type_logits
+
+
 class IsLink(FFN):
     def __init__(self, config: ITERConfig):
         num_links = config.num_links * (1 + config.is_feature_negsample_link_types)
@@ -601,6 +632,10 @@ class ITERForRelationExtraction(ITER):
         super().__init__(config)
         torch.set_rng_state(random_state)
 
+
+        self.bracketing_layer = BracketingLayer(config)
+
+
         self.threshold = config.threshold
         self.num_links = config.num_links
 
@@ -647,6 +682,11 @@ class ITERForRelationExtraction(ITER):
             return_dict=False
         )[0]
 
+
+         # تطبيق طبقة Bracketing
+        start_logits, end_logits, type_logits = self.bracketing_layer(x)
+      
+
         lr_loss = self._is_span_forward(
             x,
             actions,
02/03/2025 17:23:18 - INFO - Seed = 42
02/03/2025 17:23:18 - INFO - Dataset = conll04
02/03/2025 17:23:22 - INFO - ITERForRelationExtraction(
  (model): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(28996, 1024, padding_idx=0)
      (position_embeddings): Embedding(512, 1024)
      (token_type_embeddings): Embedding(2, 1024)
      (LayerNorm): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0-23): 24 x BertLayer(
          (attention): BertAttention(
            (self): BertSdpaSelfAttention(
              (query): Linear(in_features=1024, out_features=1024, bias=True)
              (key): Linear(in_features=1024, out_features=1024, bias=True)
              (value): Linear(in_features=1024, out_features=1024, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=1024, out_features=1024, bias=True)
              (LayerNorm): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=1024, out_features=4096, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=4096, out_features=1024, bias=True)
            (LayerNorm): LayerNorm((1024,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=1024, out_features=1024, bias=True)
      (activation): Tanh()
    )
  )
  (is_l): IsLeft(
    (dropout): Dropout(p=0.3, inplace=False)
    (gate): Linear(in_features=1024, out_features=4096, bias=False)
    (wi): Linear(in_features=1024, out_features=4096, bias=False)
    (wo): Linear(in_features=4096, out_features=1, bias=False)
    (act): GELUActivation()
  )
  (lr_score): IsSpan(
    (dropout): Dropout(p=0.3, inplace=False)
    (gate): Linear(in_features=2048, out_features=8192, bias=False)
    (wi): Linear(in_features=2048, out_features=8192, bias=False)
    (wo): Linear(in_features=8192, out_features=4, bias=False)
    (act): GELUActivation()
  )
  (bracketing_layer): BracketingLayer(
    (bracket_start): Linear(in_features=1024, out_features=1, bias=True)
    (bracket_end): Linear(in_features=1024, out_features=1, bias=True)
    (type_classifier): Linear(in_features=1024, out_features=4, bias=True)
  )
  (rr_score): IsLink(
    (dropout): Dropout(p=0.3, inplace=False)
    (gate): Linear(in_features=2048, out_features=8192, bias=False)
    (wi): Linear(in_features=2048, out_features=8192, bias=False)
    (wo): Linear(in_features=8192, out_features=5, bias=False)
    (act): GELUActivation()
  )
)
02/03/2025 17:23:22 - INFO - {
  "patience": 10,
  "num_epochs": 100,
  "max_epochs": 100,
  "lr_t5": 5e-05,
  "lr_iter": 0.0003,
  "lr_scheduler": "linear_with_warmup",
  "weight_decay": 0.1,
  "warmup_steps": 0.05,
  "task_weight_decay": 0.02,
  "task_warmup_steps": 0.01,
  "task_lr_scheduler": "linear_with_warmup",
  "activation_fn": "gelu",
  "dropout": 0.3,
  "d_ff": 0,
  "batch_size": 8,
  "gradient_accumulation": 1,
  "metric_average": "micro",
  "optimize_for": "ere",
  "eval_batch_size": 0
} for dataset conll04
02/03/2025 17:23:22 - INFO - 409.16071 M params (409160710 total)
02/03/2025 17:23:22 - INFO - Using feature 'Allow examples with no relations' (bit 2, 4)
02/03/2025 17:23:22 - INFO - Loaded dataset conll04 with splits 'train': 1153, 'eval': 231, 'test': 288,
02/03/2025 17:25:15 - INFO - NER :: pr=0.764120 rec=0.788571 f1=0.776153 ERE :: pr=0.666667 rec=0.283988 f1=0.398305 PERF :: 57.85465222512054/s
02/03/2025 17:25:15 - INFO - Action confusion: 
tensor([[     7181.,        69.,        92.,        24.],
        [       35.,       550.,         1.,        31.],
        [       76.,         0.,       532.,         9.],
        [       21.,        20.,        11.,       224.]], device='cuda:0')
02/03/2025 17:25:15 - INFO - Found new best checkpoint (ere, 0.39830506), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:27:13 - INFO - NER :: pr=0.887078 rec=0.870857 f1=0.878893 ERE :: pr=0.698745 rec=0.504532 f1=0.585965 PERF :: 59.670889209881494/s
02/03/2025 17:27:13 - INFO - Action confusion: 
tensor([[     7305.,        12.,        44.,         5.],
        [       36.,       569.,         1.,        11.],
        [       47.,         0.,       570.,         0.],
        [       25.,         6.,         5.,       240.]], device='cuda:0')
02/03/2025 17:27:13 - INFO - Found new best checkpoint (ere, 0.58596492), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:29:11 - INFO - NER :: pr=0.939858 rec=0.910857 f1=0.925131 ERE :: pr=0.821168 rec=0.679758 f1=0.743802 PERF :: 60.192483899537486/s
02/03/2025 17:29:11 - INFO - Action confusion: 
tensor([[     7332.,         8.,        23.,         3.],
        [       17.,       592.,         0.,         8.],
        [       45.,         0.,       571.,         1.],
        [       11.,         5.,         0.,       260.]], device='cuda:0')
02/03/2025 17:29:11 - INFO - Found new best checkpoint (ere, 0.74380165), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:31:16 - INFO - NER :: pr=0.976275 rec=0.940571 f1=0.958091 ERE :: pr=0.832215 rec=0.749245 f1=0.788553 PERF :: 59.891727296514865/s
02/03/2025 17:31:16 - INFO - Action confusion: 
tensor([[     7353.,         3.,         9.,         1.],
        [        5.,       611.,         0.,         1.],
        [       33.,         0.,       584.,         0.],
        [        4.,         6.,         3.,       263.]], device='cuda:0')
02/03/2025 17:31:16 - INFO - Found new best checkpoint (ere, 0.78855318), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:33:24 - INFO - NER :: pr=0.964490 rec=0.962286 f1=0.963387 ERE :: pr=0.865132 rec=0.794562 f1=0.828346 PERF :: 58.41931861669918/s
02/03/2025 17:33:24 - INFO - Action confusion: 
tensor([[     7348.,         2.,        15.,         1.],
        [        3.,       609.,         0.,         5.],
        [       22.,         0.,       594.,         1.],
        [        1.,         1.,         0.,       274.]], device='cuda:0')
02/03/2025 17:33:24 - INFO - Found new best checkpoint (ere, 0.82834643), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:35:24 - INFO - NER :: pr=0.964773 rec=0.970286 f1=0.967521 ERE :: pr=0.808333 rec=0.879154 f1=0.842258 PERF :: 57.77453242355498/s
02/03/2025 17:35:24 - INFO - Action confusion: 
tensor([[     7341.,         3.,        20.,         2.],
        [        4.,       613.,         0.,         0.],
        [       17.,         0.,       599.,         1.],
        [        1.,         0.,         2.,       273.]], device='cuda:0')
02/03/2025 17:35:24 - INFO - Found new best checkpoint (ere, 0.84225762), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:37:27 - INFO - NER :: pr=0.960137 rec=0.963429 f1=0.961780 ERE :: pr=0.856688 rec=0.812689 f1=0.834109 PERF :: 59.68682443489875/s
02/03/2025 17:37:27 - INFO - Action confusion: 
tensor([[     7344.,         5.,        14.,         3.],
        [        2.,       609.,         0.,         6.],
        [       21.,         0.,       596.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 17:39:13 - INFO - NER :: pr=0.962670 rec=0.972571 f1=0.967595 ERE :: pr=0.829060 rec=0.879154 f1=0.853372 PERF :: 59.11626691505381/s
02/03/2025 17:39:13 - INFO - Action confusion: 
tensor([[     7338.,         4.,        23.,         1.],
        [        1.,       615.,         0.,         1.],
        [       17.,         0.,       598.,         2.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 17:39:13 - INFO - Found new best checkpoint (ere, 0.85337245), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:41:39 - INFO - NER :: pr=0.947727 rec=0.953143 f1=0.950427 ERE :: pr=0.926421 rec=0.836858 f1=0.879365 PERF :: 59.47494620833525/s
02/03/2025 17:41:39 - INFO - Action confusion: 
tensor([[     7339.,         2.,        22.,         3.],
        [        6.,       611.,         0.,         0.],
        [       15.,         0.,       602.,         0.],
        [        3.,         3.,         0.,       270.]], device='cuda:0')
02/03/2025 17:41:39 - INFO - Found new best checkpoint (ere, 0.87936515), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:43:55 - INFO - NER :: pr=0.973804 rec=0.977143 f1=0.975471 ERE :: pr=0.889552 rec=0.900302 f1=0.894895 PERF :: 58.92767068669522/s
02/03/2025 17:43:55 - INFO - Action confusion: 
tensor([[     7349.,         0.,        16.,         1.],
        [        4.,       611.,         0.,         2.],
        [       16.,         0.,       601.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 17:43:55 - INFO - Found new best checkpoint (ere, 0.89489496), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:45:52 - INFO - NER :: pr=0.977247 rec=0.981714 f1=0.979475 ERE :: pr=0.900901 rec=0.906344 f1=0.903614 PERF :: 59.562355806065646/s
02/03/2025 17:45:52 - INFO - Action confusion: 
tensor([[     7351.,         1.,        12.,         2.],
        [        1.,       616.,         0.,         0.],
        [       10.,         0.,       607.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 17:45:52 - INFO - Found new best checkpoint (ere, 0.90361446), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:48:26 - INFO - NER :: pr=0.985177 rec=0.987429 f1=0.986301 ERE :: pr=0.917404 rec=0.939577 f1=0.928358 PERF :: 59.71752049606597/s
02/03/2025 17:48:26 - INFO - Action confusion: 
tensor([[     7355.,         0.,        11.,         0.],
        [        2.,       615.,         0.,         0.],
        [        9.,         0.,       608.,         0.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 17:48:26 - INFO - Found new best checkpoint (ere, 0.92835820), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 17:51:06 - INFO - NER :: pr=0.991841 rec=0.972571 f1=0.982112 ERE :: pr=0.915152 rec=0.912387 f1=0.913767 PERF :: 58.18268676276985/s
02/03/2025 17:51:06 - INFO - Action confusion: 
tensor([[     7361.,         1.,         3.,         1.],
        [        1.,       616.,         0.,         0.],
        [       21.,         0.,       596.,         0.],
        [        1.,         0.,         0.,       275.]], device='cuda:0')
02/03/2025 17:52:50 - INFO - NER :: pr=0.772727 rec=0.019429 f1=0.037904 ERE :: pr=0.000000 rec=0.000000 f1=0.000000 PERF :: 71.3259086140412/s
02/03/2025 17:52:50 - INFO - Action confusion: 
tensor([[     7363.,         3.,         0.,         0.],
        [      602.,        15.,         0.,         0.],
        [      603.,         0.,        14.,         0.],
        [      268.,         0.,         0.,         8.]], device='cuda:0')
02/03/2025 17:54:35 - INFO - NER :: pr=0.994111 rec=0.964571 f1=0.979118 ERE :: pr=0.915152 rec=0.912387 f1=0.913767 PERF :: 60.12939754190943/s
02/03/2025 17:54:35 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        5.,       612.,         0.,         0.],
        [       24.,         0.,       593.,         0.],
        [        5.,         0.,         0.,       271.]], device='cuda:0')
02/03/2025 17:56:21 - INFO - NER :: pr=0.979381 rec=0.977143 f1=0.978261 ERE :: pr=0.950658 rec=0.873112 f1=0.910236 PERF :: 60.30270496485003/s
02/03/2025 17:56:21 - INFO - Action confusion: 
tensor([[     7353.,         0.,        13.,         0.],
        [        4.,       612.,         0.,         1.],
        [       15.,         0.,       602.,         0.],
        [        0.,         0.,         1.,       275.]], device='cuda:0')
02/03/2025 17:58:06 - INFO - NER :: pr=0.981693 rec=0.980571 f1=0.981132 ERE :: pr=0.943284 rec=0.954683 f1=0.948949 PERF :: 59.68358523760478/s
02/03/2025 17:58:06 - INFO - Action confusion: 
tensor([[     7356.,         1.,         9.,         0.],
        [        5.,       612.,         0.,         0.],
        [       10.,         0.,       607.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 17:58:06 - INFO - Found new best checkpoint (ere, 0.94894886), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:00:14 - INFO - NER :: pr=0.976136 rec=0.981714 f1=0.978917 ERE :: pr=0.920118 rec=0.939577 f1=0.929746 PERF :: 58.17998956478149/s
02/03/2025 18:00:14 - INFO - Action confusion: 
tensor([[     7349.,         3.,        13.,         1.],
        [        1.,       615.,         0.,         1.],
        [       10.,         0.,       606.,         1.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:02:00 - INFO - NER :: pr=0.973804 rec=0.977143 f1=0.975471 ERE :: pr=0.947059 rec=0.972810 f1=0.959762 PERF :: 58.84699459393273/s
02/03/2025 18:02:00 - INFO - Action confusion: 
tensor([[     7354.,         0.,        12.,         0.],
        [        1.,       615.,         0.,         1.],
        [        8.,         0.,       608.,         1.],
        [        0.,         2.,         0.,       274.]], device='cuda:0')
02/03/2025 18:02:00 - INFO - Found new best checkpoint (ere, 0.95976156), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:04:43 - INFO - NER :: pr=0.990783 rec=0.982857 f1=0.986804 ERE :: pr=0.948171 rec=0.939577 f1=0.943854 PERF :: 59.60669424405528/s
02/03/2025 18:04:43 - INFO - Action confusion: 
tensor([[     7359.,         0.,         6.,         1.],
        [        0.,       617.,         0.,         0.],
        [       13.,         0.,       604.,         0.],
        [        1.,         0.,         1.,       274.]], device='cuda:0')
02/03/2025 18:06:28 - INFO - NER :: pr=0.988506 rec=0.982857 f1=0.985673 ERE :: pr=0.957447 rec=0.951662 f1=0.954545 PERF :: 57.89625197977751/s
02/03/2025 18:06:28 - INFO - Action confusion: 
tensor([[     7356.,         1.,         9.,         0.],
        [        1.,       615.,         0.,         1.],
        [       14.,         0.,       603.,         0.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 18:08:13 - INFO - NER :: pr=0.975141 rec=0.986286 f1=0.980682 ERE :: pr=0.959248 rec=0.924471 f1=0.941539 PERF :: 58.62750373590775/s
02/03/2025 18:08:13 - INFO - Action confusion: 
tensor([[     7347.,         1.,        14.,         4.],
        [        1.,       616.,         0.,         0.],
        [        8.,         0.,       609.,         0.],
        [        0.,         1.,         1.,       274.]], device='cuda:0')
02/03/2025 18:09:59 - INFO - NER :: pr=0.981818 rec=0.987429 f1=0.984615 ERE :: pr=0.969231 rec=0.951662 f1=0.960366 PERF :: 59.57773120443857/s
02/03/2025 18:09:59 - INFO - Action confusion: 
tensor([[     7355.,         0.,        11.,         0.],
        [        1.,       615.,         0.,         1.],
        [        7.,         0.,       610.,         0.],
        [        0.,         1.,         1.,       274.]], device='cuda:0')
02/03/2025 18:09:59 - INFO - Found new best checkpoint (ere, 0.96036583), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:11:56 - INFO - NER :: pr=0.986239 rec=0.982857 f1=0.984545 ERE :: pr=0.968553 rec=0.930514 f1=0.949153 PERF :: 59.92987329842841/s
02/03/2025 18:11:56 - INFO - Action confusion: 
tensor([[     7360.,         0.,         6.,         0.],
        [        1.,       616.,         0.,         0.],
        [        8.,         0.,       609.,         0.],
        [        2.,         0.,         4.,       270.]], device='cuda:0')
02/03/2025 18:13:46 - INFO - NER :: pr=0.981818 rec=0.987429 f1=0.984615 ERE :: pr=0.957576 rec=0.954683 f1=0.956127 PERF :: 59.32228370203773/s
02/03/2025 18:13:46 - INFO - Action confusion: 
tensor([[     7357.,         0.,         9.,         0.],
        [        3.,       612.,         0.,         2.],
        [        4.,         0.,       612.,         1.],
        [        1.,         0.,         1.,       274.]], device='cuda:0')
02/03/2025 18:15:32 - INFO - NER :: pr=0.991935 rec=0.984000 f1=0.987952 ERE :: pr=0.969605 rec=0.963746 f1=0.966667 PERF :: 59.835787274600094/s
02/03/2025 18:15:32 - INFO - Action confusion: 
tensor([[     7360.,         2.,         4.,         0.],
        [        3.,       614.,         0.,         0.],
        [       10.,         0.,       607.,         0.],
        [        0.,         2.,         0.,       274.]], device='cuda:0')
02/03/2025 18:15:32 - INFO - Found new best checkpoint (ere, 0.96666670), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:17:35 - INFO - NER :: pr=0.988558 rec=0.987429 f1=0.987993 ERE :: pr=0.981928 rec=0.984894 f1=0.983409 PERF :: 58.09167938410905/s
02/03/2025 18:17:35 - INFO - Action confusion: 
tensor([[     7360.,         0.,         6.,         0.],
        [        0.,       617.,         0.,         0.],
        [        6.,         0.,       611.,         0.],
        [        1.,         2.,         1.,       272.]], device='cuda:0')
02/03/2025 18:17:35 - INFO - Found new best checkpoint (ere, 0.98340875), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:19:48 - INFO - NER :: pr=0.993096 rec=0.986286 f1=0.989679 ERE :: pr=0.984227 rec=0.942598 f1=0.962963 PERF :: 57.93470355413578/s
02/03/2025 18:19:48 - INFO - Action confusion: 
tensor([[     7362.,         0.,         4.,         0.],
        [        3.,       613.,         0.,         1.],
        [       10.,         0.,       607.,         0.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 18:21:34 - INFO - NER :: pr=0.987486 rec=0.992000 f1=0.989738 ERE :: pr=0.970238 rec=0.984894 f1=0.977511 PERF :: 57.50122992557775/s
02/03/2025 18:21:34 - INFO - Action confusion: 
tensor([[     7358.,         1.,         7.,         0.],
        [        1.,       616.,         0.,         0.],
        [        3.,         0.,       613.,         1.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 18:23:20 - INFO - NER :: pr=0.990899 rec=0.995429 f1=0.993158 ERE :: pr=0.978979 rec=0.984894 f1=0.981928 PERF :: 56.77077178159004/s
02/03/2025 18:23:20 - INFO - Action confusion: 
tensor([[     7359.,         0.,         6.,         1.],
        [        1.,       615.,         0.,         1.],
        [        4.,         0.,       613.,         0.],
        [        1.,         0.,         0.,       275.]], device='cuda:0')
02/03/2025 18:25:06 - INFO - NER :: pr=0.996540 rec=0.987429 f1=0.991963 ERE :: pr=0.987578 rec=0.960725 f1=0.973966 PERF :: 57.28158896949932/s
02/03/2025 18:25:06 - INFO - Action confusion: 
tensor([[     7365.,         0.,         1.,         0.],
        [        1.,       616.,         0.,         0.],
        [        9.,         0.,       608.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:26:52 - INFO - NER :: pr=0.996556 rec=0.992000 f1=0.994273 ERE :: pr=0.967359 rec=0.984894 f1=0.976048 PERF :: 57.52410328264987/s
02/03/2025 18:26:52 - INFO - Action confusion: 
tensor([[     7363.,         0.,         3.,         0.],
        [        0.,       617.,         0.,         0.],
        [        7.,         0.,       610.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:28:37 - INFO - NER :: pr=0.994286 rec=0.994286 f1=0.994286 ERE :: pr=0.984520 rec=0.960725 f1=0.972477 PERF :: 56.93841489193279/s
02/03/2025 18:28:37 - INFO - Action confusion: 
tensor([[     7361.,         0.,         5.,         0.],
        [        0.,       617.,         0.,         0.],
        [        5.,         0.,       612.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:30:23 - INFO - NER :: pr=0.990909 rec=0.996571 f1=0.993732 ERE :: pr=0.981538 rec=0.963746 f1=0.972561 PERF :: 57.79049795177096/s
02/03/2025 18:30:23 - INFO - Action confusion: 
tensor([[     7357.,         1.,         8.,         0.],
        [        0.,       617.,         0.,         0.],
        [        2.,         0.,       615.,         0.],
        [        1.,         0.,         0.,       275.]], device='cuda:0')
02/03/2025 18:32:07 - INFO - NER :: pr=0.998845 rec=0.988571 f1=0.993682 ERE :: pr=0.978593 rec=0.966767 f1=0.972644 PERF :: 58.66158730220237/s
02/03/2025 18:32:07 - INFO - Action confusion: 
tensor([[     7366.,         0.,         0.,         0.],
        [        1.,       616.,         0.,         0.],
        [        9.,         0.,       608.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:33:54 - INFO - NER :: pr=0.996548 rec=0.989714 f1=0.993119 ERE :: pr=0.964602 rec=0.987915 f1=0.976119 PERF :: 59.33082411727964/s
02/03/2025 18:33:54 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        0.,       617.,         0.,         0.],
        [        7.,         0.,       610.,         0.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 18:35:39 - INFO - NER :: pr=0.995413 rec=0.992000 f1=0.993703 ERE :: pr=0.984940 rec=0.987915 f1=0.986425 PERF :: 59.306484424035844/s
02/03/2025 18:35:39 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        3.,       613.,         0.,         1.],
        [        6.,         0.,       611.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:35:39 - INFO - Found new best checkpoint (ere, 0.98642534), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:38:03 - INFO - NER :: pr=0.997701 rec=0.992000 f1=0.994842 ERE :: pr=0.984710 rec=0.972810 f1=0.978723 PERF :: 59.52527217327918/s
02/03/2025 18:38:03 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        0.,       617.,         0.,         0.],
        [        7.,         0.,       610.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:39:49 - INFO - NER :: pr=0.994292 rec=0.995429 f1=0.994860 ERE :: pr=0.981424 rec=0.957704 f1=0.969419 PERF :: 59.661409308070326/s
02/03/2025 18:39:49 - INFO - Action confusion: 
tensor([[     7360.,         1.,         5.,         0.],
        [        0.,       617.,         0.,         0.],
        [        4.,         0.,       613.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:41:34 - INFO - NER :: pr=0.994292 rec=0.995429 f1=0.994860 ERE :: pr=0.969880 rec=0.972810 f1=0.971342 PERF :: 59.80713652915678/s
02/03/2025 18:41:34 - INFO - Action confusion: 
tensor([[     7363.,         1.,         2.,         0.],
        [        0.,       615.,         0.,         2.],
        [        3.,         0.,       614.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:43:19 - INFO - NER :: pr=0.997712 rec=0.996571 f1=0.997141 ERE :: pr=0.979042 rec=0.987915 f1=0.983459 PERF :: 59.522427124385956/s
02/03/2025 18:43:19 - INFO - Action confusion: 
tensor([[     7363.,         1.,         2.,         0.],
        [        0.,       617.,         0.,         0.],
        [        3.,         0.,       614.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:45:04 - INFO - NER :: pr=0.996575 rec=0.997714 f1=0.997144 ERE :: pr=0.982036 rec=0.990937 f1=0.986466 PERF :: 58.15807537034734/s
02/03/2025 18:45:04 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        0.,       616.,         0.,         1.],
        [        2.,         0.,       615.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:45:04 - INFO - Found new best checkpoint (ere, 0.98646623), saving to models/conll04/bert-large-cased/2025-02-03_17-23-18
02/03/2025 18:47:39 - INFO - NER :: pr=0.996564 rec=0.994286 f1=0.995423 ERE :: pr=0.981873 rec=0.981873 f1=0.981873 PERF :: 57.48043438331608/s
02/03/2025 18:47:39 - INFO - Action confusion: 
tensor([[     7363.,         0.,         3.,         0.],
        [        0.,       617.,         0.,         0.],
        [        4.,         0.,       613.,         0.],
        [        0.,         1.,         0.,       275.]], device='cuda:0')
02/03/2025 18:49:25 - INFO - NER :: pr=0.995418 rec=0.993143 f1=0.994279 ERE :: pr=0.984756 rec=0.975831 f1=0.980273 PERF :: 57.40117015218519/s
02/03/2025 18:49:25 - INFO - Action confusion: 
tensor([[     7364.,         0.,         2.,         0.],
        [        2.,       614.,         0.,         1.],
        [        5.,         0.,       611.,         1.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:51:11 - INFO - NER :: pr=0.995418 rec=0.993143 f1=0.994279 ERE :: pr=0.976119 rec=0.987915 f1=0.981982 PERF :: 57.23143400716583/s
02/03/2025 18:51:11 - INFO - Action confusion: 
tensor([[     7362.,         0.,         4.,         0.],
        [        1.,       616.,         0.,         0.],
        [        6.,         0.,       611.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:52:55 - INFO - NER :: pr=0.995418 rec=0.993143 f1=0.994279 ERE :: pr=0.975831 rec=0.975831 f1=0.975831 PERF :: 58.00769648758247/s
02/03/2025 18:52:55 - INFO - Action confusion: 
tensor([[     7362.,         0.,         4.,         0.],
        [        0.,       617.,         0.,         0.],
        [        6.,         0.,       611.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:54:41 - INFO - NER :: pr=0.995429 rec=0.995429 f1=0.995429 ERE :: pr=0.970238 rec=0.984894 f1=0.977511 PERF :: 57.6428517118998/s
02/03/2025 18:54:41 - INFO - Action confusion: 
tensor([[     7362.,         0.,         4.,         0.],
        [        0.,       617.,         0.,         0.],
        [        4.,         0.,       613.,         0.],
        [        0.,         0.,         0.,       276.]], device='cuda:0')
02/03/2025 18:56:27 - INFO - NER :: pr=0.794118 rec=0.771429 f1=0.782609 ERE :: pr=0.686833 rec=0.583082 f1=0.630719 PERF :: 57.569548878881776/s
02/03/2025 18:56:27 - INFO - Action confusion: 
tensor([[     7194.,         0.,       172.,         0.],
        [        5.,       612.,         0.,         0.],
        [      124.,         0.,       493.,         0.],
        [       78.,         0.,         1.,       197.]], device='cuda:0')
02/03/2025 18:58:12 - INFO - NER :: pr=0.950820 rec=0.928000 f1=0.939271 ERE :: pr=0.889552 rec=0.900302 f1=0.894895 PERF :: 57.73131163397526/s
02/03/2025 18:58:12 - INFO - Action confusion: 
tensor([[     7325.,         0.,        41.,         0.],
        [        3.,       614.,         0.,         0.],
        [       51.,         0.,       565.,         1.],
        [       11.,         1.,         0.,       264.]], device='cuda:0')
02/03/2025 18:59:58 - INFO - NER :: pr=0.964953 rec=0.944000 f1=0.954362 ERE :: pr=0.891975 rec=0.873112 f1=0.882443 PERF :: 57.74946302674817/s
02/03/2025 18:59:58 - INFO - Action confusion: 
tensor([[     7337.,         0.,        29.,         0.],
        [        0.,       617.,         0.,         0.],
        [       32.,         0.,       584.,         1.],
        [       10.,         8.,         0.,       258.]], device='cuda:0')
02/03/2025 19:01:44 - INFO - NER :: pr=0.951825 rec=0.745143 f1=0.835897 ERE :: pr=0.902857 rec=0.477341 f1=0.624506 PERF :: 60.39104188491433/s
02/03/2025 19:01:44 - INFO - Action confusion: 
tensor([[7333.,    0.,   33.,    0.],
        [   0.,  617.,    0.,    0.],
        [ 205.,    0.,  412.,    0.],
        [  23.,    0.,    0.,  253.]], device='cuda:0')
02/03/2025 19:03:29 - INFO - NER :: pr=0.890542 rec=0.957714 f1=0.922907 ERE :: pr=0.884848 rec=0.441088 f1=0.588710 PERF :: 59.511082545653956/s
02/03/2025 19:03:29 - INFO - Action confusion: 
tensor([[     7266.,         1.,        99.,         0.],
        [        0.,       616.,         0.,         1.],
        [       34.,         0.,       581.,         2.],
        [        1.,         0.,         1.,       274.]], device='cuda:0')
02/03/2025 19:03:29 - INFO - No improvement for 10 epochs, aborting training in epoch 51
02/03/2025 19:03:34 - INFO - TESTING
02/03/2025 19:03:39 - INFO - NER :: pr=0.882241 rec=0.877243 f1=0.879735 ERE :: pr=0.685422 rec=0.658477 f1=0.671679 PERF :: 60.89263895253089/s
02/03/2025 19:03:39 - INFO - NER :: pr=0.897436 rec=0.892351 f1=0.894886 ERE :: pr=0.685422 rec=0.658477 f1=0.671679 PERF :: 60.89263895253089/s
